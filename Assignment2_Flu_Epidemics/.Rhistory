setwd("C:/Users/Dorota/Github/The_Analytics_Edge/Assignment2_Flue_Epidemics")
FluTrain<- read.csv("FluTrain.csv", header = TRUE)
plot(x=Week, y=ILI, data=FluTrain)
library(ggplot2)
ggplot(FluTrain, aes(Week, ILI)) +  geom_line()
ggplot(FluTrain, aes(Week, ILI,group=NULL)) +  geom_line()
library(ggplot2)
ggplot(FluTrain, aes(Week, ILI)) +  geom_bar()
qplot(Week, ILI, data=FluTrain, geom=c("point", "line"))
max(FluTRain$ILI)
max(FluTrain$ILI)
which(FluTRain$ILI==max(FluTrain$ILI))
which(FluTrain$ILI==max(FluTrain$ILI))
FluTrain[which(FluTrain$ILI==max(FluTrain$ILI))]
FluTrain[which(FluTrain$ILI==max(FluTrain$ILI)),]
qplot(Week, Queries, data=FluTrain, geom=c("point", "line"))
FluTrain[which(FluTrain$Quesries==max(FluTrain$Queries)),]
FluTrain[which(FluTrain$Queries==max(FluTrain$Queries)),]
qplot(ILI, data=FluTrain, geom="histogram")
qplot(Queries, log(ILI), data=FluTrain, geom="line")
FluTrend1<-lm(log(ILI) ~ Queries, data = FluTrain)
summary(FluTrend1)
cor(log(ILI),Queries)
cor(log(FluTrain$ILI),FluTrain$Queries)
cor(log(FluTrain$ILI),FluTrain$Queries)^2
FluTest<- read.csv("FluTest.csv", header = TRUE)
PredTest1 = exp(predict(FluTrend1, newdata=FluTest))
PredTest1[which(PredTest1$Week=='2012-03-12'),]
PredTest1[which(FluTest$Week=='2012-03-12')]
which(FluTest$Week=='2012-03-12')
FluTest$Week
PredTest1[which(FluTest$Week=='2012-03-11')]
which(FluTest$Week=='2012-03-11')
which(FluTest$Week in '%2012-03-11%')
grep('%2012-03-11%',FluTest$Week)
grep('2012-03-11',FluTest$Week)
PredTest1[grep('2012-03-11',FluTest$Week)]
(PredTest1[grep('2012-03-11',FluTest$Week)]-FluTest[grep('2012-03-11',FluTest$Week),2])
/FluTest[grep('2012-03-11',FluTest$Week),2]
(PredTest1[grep('2012-03-11',FluTest$Week)]-FluTest[grep('2012-03-11',FluTest$Week),2])/FluTest[grep('2012-03-11',FluTest$Week),2]
sqrt( mean( (PredTest1-FluTest$ILI)^2 , na.rm = TRUE ) )
install.packages("zoo")
library(zoo)
ILILag2 = lag(zoo(FluTrain$ILI), -2, na.pad=TRUE)
FluTrain$ILILag2 = coredata(ILILag2)
sum(is.na(ILILag2))
qplot(log(ILILag2), log(ILI), data=FluTrain, geom="line")
FluTrend2<-lm(log(ILI) ~ Queries+ILILag2, data = FluTrain)
summary(FluTrend12)
summary(FluTrend2)
FluTrend2<-lm(log(ILI) ~ Queries+log(ILILag2), data = FluTrain)
summary(FluTrend2)
ILILag2 = lag(zoo(FluTest$ILI), -2, na.pad=TRUE)
FluTest$ILILag2 = coredata(ILILag2)
sum(is.na(ILILag2))
FluTest$ILILag2[1] = FluTrain$ILI[416]
FluTest$ILILag2[2] = FluTrain$ILI[417]
FluTrain$ILI[416]
FluTrain$ILI[417]
PredTest2 = exp(predict(FluTrend2, newdata=FluTest))
sqrt( mean( (PredTest2-FluTest$ILI)^2 , na.rm = TRUE ) )
